<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UBC Workday Schedule to Calendar Converter</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Convert your UBC Workday course schedule to calendar format (.ics) compatible with Google Calendar, Apple Calendar, and Outlook. 100% private - all processing happens in your browser.">
    <meta name="keywords" content="UBC, Workday, calendar, schedule, converter, ics, Google Calendar, Apple Calendar, Outlook">
    <meta name="author" content="UBC Workday Calendar Converter">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="UBC Workday Schedule to Calendar Converter">
    <meta property="og:description" content="Convert your UBC course schedule from Workday to calendar format. Works with Google Calendar, Apple Calendar, and Outlook. Privacy-focused - no data uploaded.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://voctory.github.io/workday-cal/">
    <meta property="og:image" content="https://voctory.github.io/workday-cal/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="UBC Workday Calendar">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="UBC Workday Schedule to Calendar Converter">
    <meta name="twitter:description" content="Convert your UBC course schedule from Workday to calendar format. Privacy-focused tool - all processing in browser.">
    <meta name="twitter:image" content="https://voctory.github.io/workday-cal/og-image.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üìÖ</text></svg>">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "UBC Workday Schedule to Calendar Converter",
        "description": "Convert UBC Workday course schedules to calendar format (.ics) compatible with Google Calendar, Apple Calendar, and Outlook",
        "url": "https://voctory.github.io/workday-cal/",
        "applicationCategory": "UtilityApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "featureList": [
            "Convert Excel schedules to ICS format",
            "Support for all UBC terms",
            "100% client-side processing",
            "Google Calendar integration",
            "Apple Calendar support",
            "Outlook compatibility"
        ]
    }
    </script>
    
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>UBC Workday Schedule to Calendar</h1>
            <p>Convert your UBC Workday course schedule to calendar format (.ics)</p>
        </header>

        <main>
            <div id="upload-section" class="upload-area">
                <div class="upload-box" id="dropzone">
                    <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 15v4a2 2 0 002 2h14a2 2 0 002-2v-4M17 9l-5-5-5 5M12 14V4"/>
                    </svg>
                    <h2>Drop your Excel file here</h2>
                    <p>or</p>
                    <label for="file-input" class="file-label">
                        Browse Files
                        <input type="file" id="file-input" accept=".xlsx,.xls" style="display: none;">
                    </label>
                    <p class="file-info">Accepts .xlsx files exported from UBC Workday</p>
                </div>
            </div>

            <div id="preview-section" class="preview-section" style="display: none;">
                <h2>Course Schedule Preview</h2>
                <div class="view-controls">
                    <div class="view-toggle">
                        <button id="list-view-btn" class="view-btn active">üìù List View</button>
                        <button id="calendar-view-btn" class="view-btn">üìÖ Calendar View</button>
                    </div>
                    <div class="selection-controls">
                        <button id="select-all" class="btn btn-small">Select All</button>
                        <button id="select-none" class="btn btn-small">Select None</button>
                        <span id="selection-count" class="selection-count"></span>
                    </div>
                </div>
                
                <div id="list-view" class="view-container active">
                    <div id="course-list" class="course-list"></div>
                </div>
                
                <div id="calendar-view" class="view-container" style="display: none;">
                    <div id="calendar-container" class="calendar-container"></div>
                </div>
                
                <div class="export-section">
                    <h3>Export Options</h3>
                    <div class="export-options">
                        <div class="export-option">
                            <button id="download-ics" class="btn btn-primary">
                                <span class="btn-icon">üì•</span>
                                Download .ics File
                            </button>
                            <p class="option-desc">Download calendar file for importing into any calendar app</p>
                        </div>
                        
                        <div class="export-option">
                            <button id="google-calendar" class="btn btn-google">
                                <span class="btn-icon">üìÖ</span>
                                Add to Google Calendar
                            </button>
                            <p class="option-desc">Open Google Calendar to import events directly</p>
                        </div>
                        
                        <div class="export-option">
                            <button id="apple-calendar" class="btn btn-apple">
                                <span class="btn-icon">üçé</span>
                                Add to Apple Calendar
                            </button>
                            <p class="option-desc">Open in Apple Calendar (macOS/iOS)</p>
                        </div>
                        
                        <div class="export-option">
                            <button id="outlook-web" class="btn btn-outlook">
                                <span class="btn-icon">üìò</span>
                                Add to Outlook.com
                            </button>
                            <p class="option-desc">Import to Outlook.com calendar</p>
                        </div>
                        
                        <div class="export-option">
                            <button id="copy-events" class="btn btn-secondary">
                                <span class="btn-icon">üìã</span>
                                Copy Event Details
                            </button>
                            <p class="option-desc">Copy events as text for manual entry</p>
                        </div>
                    </div>
                    
                    <div class="reset-section">
                        <button id="reset" class="btn btn-secondary">Upload New File</button>
                    </div>
                </div>
            </div>

            <div id="error-section" class="error-section" style="display: none;">
                <div class="error-message" id="error-message"></div>
            </div>
            
            <div class="tutorials-section">
                <button class="tutorial-toggle" onclick="toggleTutorials()">
                    <span id="tutorial-toggle-icon">‚ñ∂</span>
                    <span>üìö Step-by-Step Tutorials</span>
                </button>
                
                <div id="tutorials-container" class="tutorials-container" style="display: none;">
                    <div class="tutorial-tabs">
                        <button class="tab-button active" onclick="showTutorial('workday')">
                            Export from Workday
                        </button>
                        <button class="tab-button" onclick="showTutorial('google')">
                            Import to Google Calendar
                        </button>
                    </div>
                    
                    <div id="workday-tutorial" class="tutorial-content active">
                        <!-- iframe will be loaded dynamically -->
                    </div>
                    
                    <div id="google-tutorial" class="tutorial-content" style="display: none;">
                        <!-- iframe will be loaded dynamically -->
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>Open source project ‚Ä¢ <a href="https://github.com/voctory/workday-cal" target="_blank">View on GitHub</a> ‚Ä¢ <a href="https://github.com/voctory/workday-cal/issues" target="_blank">Report Issues</a></p>
            <p>Privacy: All processing happens in your browser. No data is uploaded to any server.</p>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="js/parser.js"></script>
    <script src="js/calendar.js"></script>
    <script src="js/calendar-view.js"></script>
    <script src="js/app.js"></script>
    
    <script>
        let tutorialsLoaded = false;
        
        function toggleTutorials() {
            const container = document.getElementById('tutorials-container');
            const icon = document.getElementById('tutorial-toggle-icon');
            
            if (container.style.display === 'none') {
                container.style.display = 'block';
                icon.textContent = '‚ñº';
                
                // Load iframes on first open
                if (!tutorialsLoaded) {
                    loadTutorialIframes();
                    tutorialsLoaded = true;
                }
            } else {
                container.style.display = 'none';
                icon.textContent = '‚ñ∂';
            }
        }
        
        function loadTutorialIframes() {
            const workdayTutorial = document.getElementById('workday-tutorial');
            const googleTutorial = document.getElementById('google-tutorial');
            
            if (workdayTutorial && !workdayTutorial.querySelector('iframe')) {
                workdayTutorial.innerHTML = `
                    <iframe 
                        src="https://scribehow.com/embed/Accessing_and_Downloading_Course_Information_in_Workday__zWMAv7lvRpC12h39VmG4Gw" 
                        width="100%" 
                        height="640" 
                        allowfullscreen 
                        frameborder="0">
                    </iframe>
                `;
            }
            
            if (googleTutorial && !googleTutorial.querySelector('iframe')) {
                googleTutorial.innerHTML = `
                    <iframe 
                        src="https://scribehow.com/embed/Importing_UBC_Winter_2025_Calendar_into_Google_Calendar__HS7J0rjeT-SA44Z8EwcknQ" 
                        width="100%" 
                        height="640" 
                        allowfullscreen 
                        frameborder="0">
                    </iframe>
                `;
            }
        }
        
        function showTutorial(type) {
            // Hide all tutorials
            document.querySelectorAll('.tutorial-content').forEach(content => {
                content.style.display = 'none';
                content.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tutorial
            const tutorial = document.getElementById(`${type}-tutorial`);
            if (tutorial) {
                tutorial.style.display = 'block';
                tutorial.classList.add('active');
            }
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }
    </script>
</body>
</html>